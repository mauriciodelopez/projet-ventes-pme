version: '3.8'  # âœ… Version recommandÃ©e de Docker Compose

services:
  # ğŸ”¹ Service nÂ°1 : base de donnÃ©es SQLite dans un conteneur lÃ©ger
  db_sqlite:
    image: nouchka/sqlite3               # Utilise une image Docker dÃ©jÃ  prÃªte avec SQLite
    volumes:
      - db_data:/root/db                # ğŸ” CrÃ©e un volume partagÃ© pour stocker le fichier .db
    container_name: sqlite_container     # Donne un nom lisible au conteneur

  # ğŸ”¹ Service nÂ°2 : ton script Python ETL
  etl_scripts:
    build: .                             # ğŸ”¨ Construit l'image Docker Ã  partir du Dockerfile local
    volumes:
      - db_data:/app/data               # ğŸ” Monte le mÃªme volume que db_sqlite
      - ./outputs:/app/outputs          # ğŸ“¤ Pour que les fichiers gÃ©nÃ©rÃ©s sortent dans ton projet
    container_name: etl_scripts_container
    depends_on:
      - db_sqlite                       # ğŸ•’ Lance ce service uniquement aprÃ¨s que SQLite ait dÃ©marrÃ©

# ğŸ“¦ DÃ©clare le volume partagÃ© entre les 2 services
volumes:
  db_data:
